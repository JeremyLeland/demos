<link rel='stylesheet' href='../grid.css'>

<style>
  .block {
    position: absolute;
    background-color: red;
  }
</style>

<body></body>

<script>
  document.addEventListener( 'mousedown',  inputStart );
  document.addEventListener( 'touchstart', inputStart );
  document.addEventListener( 'mousemove', inputMove );
  document.addEventListener( 'touchmove', inputMove );
  document.addEventListener( 'mouseup',  inputStop );
  document.addEventListener( 'touchend', inputStop );

  const SIZE = 32;
  const Direction = { Horizontal: { x: 1, y: 0 }, Vertical: { x: 0, y: 1 } };

  class Block {
    x = 0;
    y = 0;
    width = 0;
    height = 0;
    direction = Direction.Horizontal;
    
    #div;

    constructor( values ) {
      Object.assign( this, values );

      this.#div = document.createElement( 'div' );
      this.#div.className = 'block';
      this.#div.style.width = this.width;
      this.#div.style.height = this.height;
      this.#div.owner = this;
      
      this.#updateDiv();

      document.body.appendChild( this.#div );
    }

    moveBy( x, y ) {
      this.x += this.direction.x * x;
      this.y += this.direction.y * y;

      this.#updateDiv();
    }

    #updateDiv() {
      this.#div.style.transform = `translate( ${ this.x }px,${ this.y }px )`;
    }
  }

  const blocks = [
    new Block( { x: SIZE * 1, y: SIZE * 3, width: SIZE * 3, height: SIZE * 1, direction: Direction.Horizontal } ),
    new Block( { x: SIZE * 5, y: SIZE * 2, width: SIZE * 1, height: SIZE * 4, direction: Direction.Vertical } ),
  ];

  let activeBlock, lastX, lastY;
  function inputStart( e ) {
    if ( e.target.owner ) {
      activeBlock = e.target.owner;

      const pos = e.touches?.[ 0 ] ?? e;
      lastX = pos.pageX;
      lastY = pos.pageY;
    }
  }

  function inputMove( e ) {
    if ( activeBlock ) {
      const pos = e.touches?.[ 0 ] ?? e;
      const dx = pos.pageX - lastX;
      const dy = pos.pageY - lastY;
      lastX = pos.pageX;
      lastY = pos.pageY;

      activeBlock.moveBy( dx, dy );
    }
  }

  function inputStop( e ) {
    activeBlock = null;
  }

</script>