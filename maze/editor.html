<title>Cell Maze Editor</title>
<link rel="stylesheet" href="../style.css">

<body>
  <canvas id="canvas" width="800px" height="800px"></canvas>
</body>

<script type="module">
  import { Cell } from '../src/Cell.js';
  import { CellMap } from '../src/CellMap.js';
  import * as CellGrid from '../src/CellGrid.js';
  
  const width = 900, height = 900;
  const MIN_EDGE_LENGTH = 40;

  const cellMap = CellMap.fromCellGrid( CellGrid.getHexTriangleGrid( 10, 10, 64, 32 ) );
  cellMap.fullyLink();
    
  const ctx = document.getElementById( 'canvas' ).getContext( '2d' );

  draw();

  let mouseDown = false;
  document.addEventListener( 'mousedown', ( e ) => {
    mouseDown = true;
    removeUnder( e.clientX, e.clientY );
  } );
  document.addEventListener( 'mousemove', ( e ) => {
    if ( mouseDown ) {
      removeUnder( e.clientX, e.clientY );
    }
  } );
  document.addEventListener( 'mouseup', ( e ) => mouseDown = false );

  function removeUnder( x, y ) {
    const cell = cellMap.cells.find( cell => cell.contains( x, y ) );
    if ( cell ) {
      cellMap.removeCell( cell );
      draw();
    }
  }

  function draw() {
    ctx.clearRect( 0, 0, ctx.canvas.width, ctx.canvas.height );

    cellMap.cells.forEach( cell => cell.draw( ctx ) );
  }


</script>