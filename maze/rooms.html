<title>Rooms</title>
<link rel="stylesheet" href="../style.css">

<body>
  <canvas id="canvas" width="800px" height="800px"></canvas>
</body>

<script type="module">
  import { Curve } from '../src/Curve.js';

  const CELL_SIZE = 64, OFFSET = 25, COLS = 10, ROWS = 10;

  const cellPoints = Array.from( 
    Array( COLS + 1 ), ( _, col ) => Array.from( 
      Array( ROWS + 1 ), ( _, row ) => ( { 
        x: col, 
        y: row,
        angle: Math.random() * Math.PI * 2,
        dist: 0.5 + 0.5 * Math.random(),
      } ) 
    )
  );

  const ctx = document.getElementById( 'canvas' ).getContext( '2d' );
  ctx.translate( CELL_SIZE / 2, CELL_SIZE / 2 );
  debugCells( cellPoints );
  
  function debugCells( cellPoints ) {
    for ( let row = 0; row < ROWS; row ++ ) {
      for ( let col = 0; col < COLS; col ++ ) {
        const NW = getPoint( cellPoints[ col ][ row ] );
        const NE = getPoint( cellPoints[ col + 1 ][ row ] );
        const SW = getPoint( cellPoints[ col ][ row + 1 ] );
        const SE = getPoint( cellPoints[ col + 1 ][ row + 1 ] );
        
        ctx.beginPath();
        [ NW, NE, SE, SW ].forEach( point => {
          ctx.lineTo( point.x, point.y );
        } );
        ctx.closePath();

        ctx.strokeStyle = '#333333';
        ctx.stroke();
      }
    }
  }

  function getPoint( point ) {
    return {
      x: point.x * CELL_SIZE + Math.cos( point.angle ) * point.dist * OFFSET,
      y: point.y * CELL_SIZE + Math.sin( point.angle ) * point.dist * OFFSET,
    };
  }

</script>
